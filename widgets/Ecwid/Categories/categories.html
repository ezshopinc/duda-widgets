<h2 class="section_title">Featured Categories</h2>

<div id="div1" class="wrapper">
</div>
<div style="display: flex; justify-content: end;">
    <a href="/store#!/~/search" class="see_more_btn button">Shop All</a>
</div>

<!--<button onClick="myFunction()" class="see_more_btn button">API CALL</button>-->

<script>
    function myFunction() {
        let totalProducts = 0;
        const nbToDisplay = 4;
        let htmlOutput = "";

        const currentDiv = document.getElementById("div1");

        let url = 'https://app.ecwid.com/api/v3/{{STORE_ID}}/categories';
        const options = {
            method: 'GET',
            headers: { accept: 'application/json', Authorization: 'Bearer {{API_KEY}}' }
        };


        console.log(url)

        fetch(url, options)
            .then(res => res.json())
            .then(json => {
                console.log(json)
                totalProducts = json.count
                let productId = 0;
                for (let i = 0; i < nbToDisplay; i++) {
                    console.log(json.items[i])
                    productId = json.items[i].id
                    htmlOutput += `
                     <a href="/store#!/~/search/categories=${json.items[i].id}" class="card has-bg-img" style="background-image: url(${json.items[i].thumbnailUrl || ''})">
      <span class="card__title">${json.items[i].name}</span>
  </a>`
                }

                return htmlOutput;
            }).then(htmlOutput => {
                console.log(htmlOutput.toString())
                currentDiv.innerHTML = htmlOutput;
            })
            .catch(err => console.error('error:' + err));
    }
    window.onload = myFunction;

    
</script>
<script data-cfasync="false" type="text/javascript"
    src="https://app.ecwid.com/script.js?61982800&data_platform=singleproduct_v2" charset="utf-8"></script>
<script type="text/javascript">xProduct()</script>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>